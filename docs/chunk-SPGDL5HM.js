import{a as q,b as Q,c as z,d as v,e as k}from"./chunk-QUMWIP3P.js";import{Ba as l,C as S,Da as d,H as T,Ha as m,I as D,Ia as p,J as P,Ja as h,Ka as W,L as x,Ma as E,Na as H,Oa as u,Qa as C,Ra as _,Sa as I,U as F,Ua as y,V as B,Va as R,W as g,Wa as j,c as M,cb as A,hb as U,ka as O,ma as s,ra as c,sa as G,ta as L,w as b,za as f}from"./chunk-NLSJN6CT.js";function N(n,i){if(n&1&&h(0,"img",3),n&2){let w=i;l("src",w.base64DataURL,O)("alt",w.filename)}}var J=(()=>{let i=class i{constructor(){this.imageInfo=L.required()}fileChange(r){let e=r.target.files?.[0];if(!e)return;let t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>{let o=t.result;if(o&&typeof o=="string"){let a=o.substring(`data:${e.type};base64,`.length);this.imageInfo.set({base64DataURL:o,base64Data:a,mimeType:e.type,filename:e.name})}}}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=g({type:i,selectors:[["app-image-preview"]],inputs:{imageInfo:[B.SignalBased,"imageInfo"]},outputs:{imageInfo:"imageInfoChange"},standalone:!0,features:[y],decls:5,vars:1,consts:[["for","fileInput"],["id","fileInput","name","fileInput","alt","image input","type","file","accept",".jpg,.jpeg,.png",3,"change"],["width","250","height","250"],["width","250","height","250",3,"src","alt"]],template:function(e,t){if(e&1&&(m(0,"div")(1,"label",0),u(2,"Select an image:"),p(),m(3,"input",1),W("change",function(a){return t.fileChange(a)}),p()(),f(4,N,1,2,"img",2)),e&2){let o;s(4),d(4,(o=t.imageInfo())?4:-1,o)}},styles:["input[type=file][_ngcontent-%COMP%]{margin-bottom:.75rem}label[_ngcontent-%COMP%]{margin-right:.5rem}img[_ngcontent-%COMP%]{object-fit:contain}"],changeDetection:0});let n=i;return n})();function V(n,i){n&1&&h(0,"app-chat-history",3),n&2&&l("chatHistory",i)}var ge=(()=>{let i=class i{constructor(){this.promptBox=G.required(v),this.geminiService=F(k),this.prompt=c(""),this.loading=c(!1),this.imageInfo=c(null),this.viewModel=A(()=>({isLoading:this.loading(),base64Data:this.imageInfo()?.base64Data,mimeType:this.imageInfo()?.mimeType,prompt:this.prompt()}))}get vm(){return this.viewModel()}ngOnInit(){this.chatHistory$=q(this.promptBox().askMe).pipe(b(()=>this.vm.prompt!==""&&!!this.vm.base64Data),x(()=>this.loading.set(!0)),P(()=>{let t=this.vm,{isLoading:r}=t,e=M(t,["isLoading"]);return this.geminiService.generateTextFromMultimodal(e).pipe(S(()=>this.loading.set(!1)))}),T((r,e)=>r.concat({prompt:this.prompt(),response:e}),[]),D([]))}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=g({type:i,selectors:[["app-generate-text-multimodal"]],viewQuery:function(e,t){e&1&&E(t.promptBox,v,5),e&2&&H()},standalone:!0,features:[y],decls:7,vars:6,consts:[[1,"container"],[1,"image-preview",3,"imageInfoChange","imageInfo"],[3,"promptChange","loading","prompt"],[3,"chatHistory"]],template:function(e,t){if(e&1&&(m(0,"h3"),u(1,"Input a prompt and select an image to receive an answer from the Google Gemini AI"),p(),m(2,"div",0)(3,"app-image-preview",1),I("imageInfoChange",function(a){return _(t.imageInfo,a)||(t.imageInfo=a),a}),p(),m(4,"app-prompt-box",2),I("promptChange",function(a){return _(t.prompt,a)||(t.prompt=a),a}),p()(),f(5,V,1,1,"app-chat-history"),R(6,"async")),e&2){let o;s(3),C("imageInfo",t.imageInfo),s(),l("loading",t.loading()),C("prompt",t.prompt),s(),d(5,(o=j(6,4,t.chatHistory$))?5:-1,o)}},dependencies:[Q,z,J,v,U],styles:["h3[_ngcontent-%COMP%]{margin-bottom:1rem}div.container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.image-preview[_ngcontent-%COMP%]{margin-bottom:.75rem}"],changeDetection:0});let n=i;return n})();export{ge as GenerateTextMultimodalComponent};
